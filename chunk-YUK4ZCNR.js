import{a as X}from"./chunk-XAX26MWK.js";import{d as G,e as O,f as $,g as Z,i as F,m as D,n as Y,s as W}from"./chunk-D2UWJCSF.js";import{$ as g,Bb as A,Cb as R,Db as N,Eb as j,Fb as p,Gb as P,Hb as x,Ja as l,R as z,Sa as U,V,Ya as k,a as C,aa as m,b as M,ba as h,bb as _,ca as w,ha as B,hb as c,ib as r,jb as a,kb as f,la as I,o as T,ob as H,pb as L,qb as v,tb as b,vb as d}from"./chunk-6TAOHXN6.js";function Q(i,t){if(i&1){let e=v();r(0,"button",4),b("click",function(){g(e);let o=d();return m(o.onBack())}),h(),r(1,"svg",5),f(2,"line",6)(3,"polyline",7),a(),w(),r(4,"span"),p(5,"Volver"),a()()}}var y=class i{title="";showBackButton=!0;back=new B;onBack(){this.back.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=k({type:i,selectors:[["app-page-header"]],inputs:{title:"title",showBackButton:"showBackButton"},outputs:{back:"back"},decls:6,vars:2,consts:[[1,"page-header"],["class","back-btn",3,"click",4,"ngIf"],[1,"header-title"],[1,"header-spacer"],[1,"back-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["x1","19","y1","12","x2","5","y2","12"],["points","12 19 5 12 12 5"]],template:function(e,n){e&1&&(r(0,"header",0),_(1,Q,6,0,"button",1),r(2,"div",2)(3,"h1"),p(4),a()(),f(5,"div",3),a()),e&2&&(l(),c("ngIf",n.showBackButton),l(3),P(n.title))},dependencies:[F,O],styles:[".page-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:20px 32px;background:#2d2d2d;border-bottom:1px solid #3d3d3d;position:sticky;top:0;z-index:100;box-shadow:0 2px 8px #00000026}.back-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 18px;background:transparent;border:1px solid #565869;border-radius:10px;color:#ececec;font-size:.95rem;font-weight:500;cursor:pointer;transition:all .2s ease}.back-btn[_ngcontent-%COMP%]:hover{background:#3d3d3d;border-color:#6e6e80;transform:translate(-2px)}.back-btn[_ngcontent-%COMP%]:active{transform:translate(-1px)}.back-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.header-title[_ngcontent-%COMP%]{flex:1;text-align:center}.header-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#ececec;margin:0;letter-spacing:-.02em}.header-spacer[_ngcontent-%COMP%]{width:110px}"]})};var S=class i{constructor(t){this.http=t}UPLOAD_URL="https://takesolut.app.n8n.cloud/webhook/f485251b-f901-4214-a3b3-2bbe40b98197";uploadFile(t){let e=new FormData;return e.append("data",t),e.append("fileName",t.name),this.http.post(this.UPLOAD_URL,e,{reportProgress:!0,observe:"events"}).pipe(T(n=>{if(n.type===D.UploadProgress&&n.total)return{status:"progress",progress:Math.round(100*n.loaded/n.total)};if(n.type===D.Response){let o=n.body;return{status:"complete",progress:100,fileId:o?.fileId,message:o?.message}}return{status:"progress",progress:0}}))}static \u0275fac=function(e){return new(e||i)(V(Y))};static \u0275prov=z({token:i,factory:i.\u0275fac,providedIn:"root"})};function te(i,t){if(i&1&&(r(0,"div",32),f(1,"div",33),a()),i&2){let e=d().$implicit;l(),R("width",e.progress,"%")}}function ne(i,t){if(i&1&&(r(0,"div",34),p(1),a()),i&2){let e=d().$implicit;l(),x(" ",e.error," ")}}function ie(i,t){i&1&&(r(0,"span"),p(1,"Pendiente"),a())}function oe(i,t){if(i&1&&(r(0,"span"),p(1),a()),i&2){let e=d().$implicit;l(),x("",e.progress,"%")}}function re(i,t){i&1&&(r(0,"span"),p(1,"\u2713 Completado"),a())}function ae(i,t){i&1&&(r(0,"span"),p(1,"\u2717 Error"),a())}function le(i,t){if(i&1){let e=v();r(0,"button",35),b("click",function(){g(e);let o=d().index,s=d(2);return m(s.removeFile(o))}),h(),r(1,"svg",36),f(2,"line",37)(3,"line",38),a()()}}function se(i,t){if(i&1&&(r(0,"div",17)(1,"div",18),h(),r(2,"svg",19),f(3,"path",20)(4,"polyline",21),a()(),w(),r(5,"div",22)(6,"div",23),p(7),a(),r(8,"div",24),p(9),a(),_(10,te,2,2,"div",25)(11,ne,2,1,"div",26),a(),r(12,"div",27)(13,"span",28),H(14,29),_(15,ie,2,0,"span",30)(16,oe,2,1,"span",30)(17,re,2,0,"span",30)(18,ae,2,0,"span",30),L(),a()(),_(19,le,4,0,"button",31),a()),i&2){let e=t.$implicit,n=d(2);l(7),P(e.file.name),l(2),P(n.formatFileSize(e.file.size)),l(),c("ngIf",e.status==="uploading"),l(),c("ngIf",e.status==="error"),l(2),j(e.status),l(),c("ngSwitch",e.status),l(),c("ngSwitchCase","pending"),l(),c("ngSwitchCase","uploading"),l(),c("ngSwitchCase","success"),l(),c("ngSwitchCase","error"),l(),c("ngIf",e.status!=="uploading")}}function pe(i,t){if(i&1&&(r(0,"div",15)(1,"h3"),p(2),a(),_(3,se,20,12,"div",16),a()),i&2){let e=d();l(2),x("Archivos seleccionados (",e.files().length,")"),l(),c("ngForOf",e.files())}}function ce(i,t){if(i&1){let e=v();r(0,"div",39)(1,"div",40)(2,"span",41),p(3),a(),r(4,"button",42),b("click",function(){g(e);let o=d();return m(o.uploadFiles())}),h(),r(5,"svg",36),f(6,"path",8)(7,"polyline",9)(8,"line",10),a(),p(9),a()()()}if(i&2){let e=d();l(3),x("",e.files().length," archivo(s) seleccionado(s)"),l(),c("disabled",!e.hasFilesToUpload||e.isUploading),l(5),x(" ",e.isUploading?"Subiendo...":"Subir Archivos al RAG"," ")}}var E=class i{constructor(t,e){this.fileUploadService=t;this.router=e}files=I([]);isDragging=I(!1);ALLOWED_TYPES=["application/pdf","application/zip","application/x-zip-compressed"];MAX_FILE_SIZE=50*1024*1024;goBack(){this.router.navigate(["/chat"])}onDragOver(t){t.preventDefault(),t.stopPropagation(),this.isDragging.set(!0)}onDragLeave(t){t.preventDefault(),t.stopPropagation(),this.isDragging.set(!1)}onDrop(t){t.preventDefault(),t.stopPropagation(),this.isDragging.set(!1);let e=t.dataTransfer?.files;e&&this.handleFiles(Array.from(e))}onFileSelected(t){let e=t.target;e.files&&(this.handleFiles(Array.from(e.files)),e.value="")}handleFiles(t){let n=t.filter(o=>this.validateFile(o)).map(o=>({file:o,progress:0,status:"pending"}));this.files.update(o=>[...o,...n])}validateFile(t){return this.ALLOWED_TYPES.includes(t.type)?t.size>this.MAX_FILE_SIZE?(alert(`Archivo muy grande: ${t.name}. M\xE1ximo 50MB.`),!1):!0:(alert(`Archivo no permitido: ${t.name}. Solo se permiten PDF y ZIP.`),!1)}removeFile(t){this.files.update(e=>e.filter((n,o)=>o!==t))}uploadFiles(){this.files().filter(e=>e.status==="pending").forEach((e,n)=>{this.uploadSingleFile(e,this.files().indexOf(e))})}uploadSingleFile(t,e){this.files.update(n=>{let o=[...n];return o[e]=M(C({},o[e]),{status:"uploading"}),o}),this.fileUploadService.uploadFile(t.file).subscribe({next:n=>{n.status==="progress"?this.files.update(o=>{let s=[...o];return s[e]=M(C({},s[e]),{progress:n.progress}),s}):n.status==="complete"&&(this.files.update(o=>{let s=[...o];return s[e]=M(C({},s[e]),{status:"success",progress:100,fileId:n.fileId}),s}),console.log("Archivo subido exitosamente:",n.fileId))},error:n=>{console.error("Error al subir archivo:",n),this.files.update(o=>{let s=[...o];return s[e]=M(C({},s[e]),{status:"error",error:n.message||"Error al subir archivo"}),s})}})}get hasFilesToUpload(){return this.files().some(t=>t.status==="pending")}get isUploading(){return this.files().some(t=>t.status==="uploading")}formatFileSize(t){if(t===0)return"0 Bytes";let e=1024,n=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(t)/Math.log(e));return Math.round(t/Math.pow(e,o)*100)/100+" "+n[o]}static \u0275fac=function(e){return new(e||i)(U(S),U(W))};static \u0275cmp=k({type:i,selectors:[["app-file-upload"]],decls:23,vars:4,consts:[["fileInput",""],[1,"app-layout"],[1,"upload-area"],["title","Cargar Documentos al RAG",3,"back"],[1,"upload-container"],[1,"upload-intro"],[1,"drop-zone",3,"dragover","dragleave","drop","click"],["width","64","height","64","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","17 8 12 3 7 8"],["x1","12","y1","3","x2","12","y2","15"],[1,"file-types"],["type","file","multiple","","accept",".pdf,.zip",2,"display","none",3,"change"],["class","files-list",4,"ngIf"],["class","upload-actions-bar",4,"ngIf"],[1,"files-list"],["class","file-item",4,"ngFor","ngForOf"],[1,"file-item"],[1,"file-icon"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"],["points","13 2 13 9 20 9"],[1,"file-info"],[1,"file-name"],[1,"file-size"],["class","progress-bar",4,"ngIf"],["class","file-error",4,"ngIf"],[1,"file-status"],[1,"status-badge"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","remove-btn",3,"click",4,"ngIf"],[1,"progress-bar"],[1,"progress-fill"],[1,"file-error"],[1,"remove-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"upload-actions-bar"],[1,"actions-content"],[1,"files-count"],[1,"upload-btn",3,"click","disabled"]],template:function(e,n){if(e&1){let o=v();r(0,"div",1),f(1,"app-sidebar"),r(2,"div",2)(3,"app-page-header",3),b("back",function(){return g(o),m(n.goBack())}),a(),r(4,"div",4)(5,"div",5)(6,"p"),p(7,"Sube archivos PDF o ZIP para alimentar la base de conocimiento"),a()(),r(8,"div",6),b("dragover",function(u){return g(o),m(n.onDragOver(u))})("dragleave",function(u){return g(o),m(n.onDragLeave(u))})("drop",function(u){return g(o),m(n.onDrop(u))})("click",function(){g(o);let u=A(20);return m(u.click())}),h(),r(9,"svg",7),f(10,"path",8)(11,"polyline",9)(12,"line",10),a(),w(),r(13,"h3"),p(14,"Arrastra archivos aqu\xED"),a(),r(15,"p"),p(16,"o haz clic para seleccionar"),a(),r(17,"span",11),p(18,"PDF o ZIP (m\xE1x. 50MB)"),a(),r(19,"input",12,0),b("change",function(u){return g(o),m(n.onFileSelected(u))}),a()(),_(21,pe,4,2,"div",13),a(),_(22,ce,10,3,"div",14),a()()}e&2&&(l(8),N("dragging",n.isDragging()),l(13),c("ngIf",n.files().length>0),l(),c("ngIf",n.files().length>0))},dependencies:[F,G,O,$,Z,y,X],styles:["[_nghost-%COMP%]{display:block;height:100vh}.app-layout[_ngcontent-%COMP%]{display:flex;height:100%;background-color:#343541}.upload-area[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;height:100%;overflow:hidden}.upload-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;max-width:900px;margin:0 auto;padding:40px 20px;width:100%}.upload-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.upload-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#2d2d2d}.upload-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#565869;border-radius:4px}.upload-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6e6e80}.upload-intro[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px}.upload-intro[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#8e8ea0;font-size:1rem;line-height:1.5}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #565869;border-radius:16px;padding:60px 40px;text-align:center;background:#40414f;cursor:pointer;transition:all .3s ease}.drop-zone[_ngcontent-%COMP%]:hover{border-color:#6e6e80;background:#444654}.drop-zone.dragging[_ngcontent-%COMP%]{border-color:#4cc9f0;background:#444654;transform:scale(1.02);box-shadow:0 0 20px #4cc9f04d}.drop-zone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#8e8ea0;margin-bottom:20px}.drop-zone[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;margin-bottom:8px;color:#ececec}.drop-zone[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#8e8ea0;margin-bottom:12px}.drop-zone[_ngcontent-%COMP%]   .file-types[_ngcontent-%COMP%]{display:inline-block;background:#2d2d2d;color:#8e8ea0;padding:6px 12px;border-radius:6px;font-size:.85rem}.files-list[_ngcontent-%COMP%]{margin-top:40px}.files-list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin-bottom:20px;color:#ececec}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;background:#40414f;border:1px solid #565869;border-radius:12px;padding:16px;margin-bottom:12px;transition:all .2s ease}.file-item[_ngcontent-%COMP%]:hover{background:#444654;border-color:#6e6e80}.file-icon[_ngcontent-%COMP%]{flex-shrink:0;width:40px;height:40px;background:#2d2d2d;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#4cc9f0}.file-info[_ngcontent-%COMP%]{flex:1;min-width:0}.file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-weight:500;color:#ececec;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.file-info[_ngcontent-%COMP%]   .file-size[_ngcontent-%COMP%]{font-size:.85rem;color:#8e8ea0}.file-info[_ngcontent-%COMP%]   .file-error[_ngcontent-%COMP%]{font-size:.85rem;color:#ff6b6b;margin-top:4px}.progress-bar[_ngcontent-%COMP%]{width:100%;height:4px;background:#2d2d2d;border-radius:2px;margin-top:8px;overflow:hidden}.progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#4cc9f0,#4361ee);transition:width .3s ease}.file-status[_ngcontent-%COMP%]{flex-shrink:0}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 12px;border-radius:6px;font-size:.85rem;font-weight:500}.status-badge.pending[_ngcontent-%COMP%]{background:#2d2d2d;color:#8e8ea0}.status-badge.uploading[_ngcontent-%COMP%]{background:#4cc9f033;color:#4cc9f0}.status-badge.success[_ngcontent-%COMP%]{background:#4cf08c33;color:#4cf08c}.status-badge.error[_ngcontent-%COMP%]{background:#ff6b6b33;color:#ff6b6b}.remove-btn[_ngcontent-%COMP%]{flex-shrink:0;width:32px;height:32px;background:transparent;border:none;border-radius:6px;color:#8e8ea0;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.remove-btn[_ngcontent-%COMP%]:hover{background:#565869;color:#ececec}.upload-actions-bar[_ngcontent-%COMP%]{background:linear-gradient(180deg,transparent 0%,#343541 20%);padding:20px;border-top:1px solid #565869;background-color:#343541;position:sticky;bottom:0;left:0;right:0}.upload-actions-bar[_ngcontent-%COMP%]   .actions-content[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:16px}.upload-actions-bar[_ngcontent-%COMP%]   .files-count[_ngcontent-%COMP%]{color:#8e8ea0;font-size:.95rem}.upload-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:14px 32px;background:linear-gradient(90deg,#4361ee,#3f37c9);border:none;border-radius:12px;color:#fff;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s ease}.upload-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 15px #4361ee66}.upload-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;transform:none}.upload-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}"]})};var Ue=[{path:"",component:E}];export{Ue as FILE_UPLOAD_ROUTES};
